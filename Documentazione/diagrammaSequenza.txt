@startuml

title "Progetto - SabbiaPallina"

actor Utente
participant NB_ProcessingScatola
entity DatiCondivisi
participant ThScatola
participant ThPallina
participant Pallina
participant Sabbia
participant Sensore
participant SwingGui

Utente -> NB_ProcessingScatola : Avvio programma

NB_ProcessingScatola -> DatiCondivisi : new DatiCondivisi
NB_ProcessingScatola -> SwingGui : passa DatiCondivisi
NB_ProcessingScatola -> SwingGui : Avvio interfaccia utente
NB_ProcessingScatola -> DatiCondivisi : Wait sincroGuiMain
SwingGui -> DatiCondivisi : Salvataggio num scatole
SwingGui -> DatiCondivisi : aggiornamento DatiCondivisi
SwingGui -> DatiCondivisi : Signal sincroGuiMain
NB_ProcessingScatola <- DatiCondivisi : Riattiva thread
DatiCondivisi -> NB_ProcessingScatola : aggiornamento DatiCondivisi
NB_ProcessingScatola -> ThScatola : new ThScatola[][]
ThScatola -> Sabbia : Aggiornamento posizione sabbia[][]
NB_ProcessingScatola -> ThPallina : new ThPallina
NB_ProcessingScatola -> DatiCondivisi : dimensioni schermo
NB_ProcessingScatola -> NB_ProcessingScatola : aggiorna variabili schermo
NB_ProcessingScatola -> Utente : creazione Scatole con pallina
SwingGui -> DatiCondivisi : aggiornamento inclinazioni
DatiCondivisi -> NB_ProcessingScatola : aggiornamento inclinazioni
NB_ProcessingScatola -> ThScatola : thScatola[][].start
NB_ProcessingScatola -> ThPallina : thPallina.start

SwingGui -> DatiCondivisi : aggiornamento inclinazioni
DatiCondivisi -> ThScatola : aggiornamento inclinazioni
ThScatola -> ThScatola : aggiornamento inclinazione
ThScatola -> Sabbia : aggiornamento posizione sabbia
Sabbia -> ThScatola : dati aggiornati
ThScatola -> ThScatola : draw sabbia

DatiCondivisi -> ThPallina : aggiornamento inclinazioni
ThPallina -> ThPallina : aggiornamento inclinazione
ThPallina -> Pallina : aggiornamento posizione pallina
Pallina -> ThPallina : dati aggiornati
ThPallina -> ThPallina : draw pallina

Utente -> SwingGui : stop
SwingGui -> DatiCondivisi : stop
DatiCondivisi -> ThScatola : stop
ThScatola -> NB_ProcessingScatola : join
DatiCondivisi -> ThPallina : stop
ThPallina -> NB_ProcessingScatola : join
DatiCondivisi -> SwingGui : stop
DatiCondivisi -> NB_ProcessingScatola : stop
SwingGui -> SwingGui : exit
NB_ProcessingScatola -> NB_ProcessingScatola : exit
NB_ProcessingScatola -> Utente : chiusura programma

@enduml